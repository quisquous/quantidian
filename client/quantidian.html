<head>
  <title>quantidian</title>
</head>

<body>
  {{#if currentUser}}
    {{> main}}
  {{else}}
    {{loginButtons}}
  {{/if}}
</body>

<template name="main">
  <div class="container-fluid">
    <div class="span3 tabbable tabs-left">
      <ul id="categoryTabs" class="nav nav-tabs">
        <li class="active"><a href="#maintab" data-toggle="tab">Home</a></li>
        {{#each subscribed}}
          <li class="categoryTab"><a href="#{{_id}}" data-toggle="tab">{{name}}</a></li>
        {{/each}}
      </ul>
    </div>
    <div class="span9 tab-content">
      <div class="tab-pane active" id="maintab">
        {{> logEntries}}
      </div>
      {{#each subscribed}}
        {{> category}}
      {{/each}}
    </div>
  </div>
  {{> dataModal}}
</template>

<template name="logEntries">
  <div class="logContainer">
    {{#each recentLogs}}
      <div class="text-info">{{stringifyLog}}</div>
    {{/each}}
  </div>
</template>

<template name="category">
  <div class="tab-pane category" id="{{_id}}">
    <h1 class="question">{{longdesc}}</h1>
    <!-- FIXME: this should probably be JS -->
    {{#if typeIs "multiplechoice"}}
      {{#each choices}}
        {{> typeChoice}}
      {{/each}}
    {{/if}}
    {{#if typeIs "text"}}
      {{> typeText}}
    {{/if}}
  </div>
</template>

<template name="typeChoice">
  <button class="btn btn-large btn-primary btn-block">{{desc}}</button>
</template>

<template name="typeText">
  <div>
    <input class="text input-xxlarge" type="text"></input>
  </div>
  <button class="save btn btn-large btn-primary">Save</button>
</template>

<template name="dataModal">
  <div id="dataModal" class="modal hide fade">
    {{#with confirmData}}
      <div class="modal-header">
        <button type="button" class="close" data-dismiss="modal">Ã—</button>
      </div>
      <div class="modal-body">
        <h1>{{categoryName}}: {{valueString}}</h1>
        <p>Time: {{dateString}}</p>
        <p>Location: {{locationString}}</p>

        <label>Comment</label>
        <input id="modalComment" class="input-large" type="text"></input>
      </div>
      <div class="modal-footer">
        <button class="btn btn-large" data-dismiss="modal">Close</button>
        <button class="accept btn btn-large btn-primary">Save</button>
      </div>
    {{/with}}
  </div>
</template>
