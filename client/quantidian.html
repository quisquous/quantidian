<head>
</head>

<body>
  {{#if currentUser}}
    {{> main}}
  {{else}}
    {{loginButtons}}
  {{/if}}
</body>

<template name="main">
  <div class="page">
    <header class="action-bar">
      <a href="#" class="app-icon action"><i class="icon-star-full"></i></a>
      <h1 class="title">Quantidian</h1>
      <ul class="actions">
        <li>
          <a href="subscribe.html" class="action" title="Subscriptions">
            <i class="icon-new"></i>
          </a>
        </li>
        <li>
          <a href="editor.html" class="action" title="Editor">
            <i class="icon-edit"></i>
          </a>
        </li>
        <li>
          <a href="logs.html" class="action" title="Logs">
            <i class="icon-view-as-list"></i>
          </a>
        </li>
      </ul>
    </header>
    <div class="content inset">
      {{#each subscribed}}
        <a href="question.html?id=#{{_id}}">
          <button type="button" class="btn btn-block">{{name}}</button>
        </a>
      {{/each}}
      {{> logEntries}}
    </div>
  </div>
</template>

<template name="logEntries">
  <ul class="list inset">
    <li class="list-divider">Recent logs</li>
      {{#each recentLogs}}
        <li class="list-item-single-line">{{stringifyLog}}</li>
      {{/each}}
  </ul>
</template>

<template name="category">
  <div class="tab-pane category" id="{{_id}}">
    {{#each questions}}
      <label>{{label}}</label>
      <!-- FIXME: this should probably be JS -->
      {{#if typeIs "multiplechoice"}}
        <div class="btn-group" data-toggle="buttons-radio">
          {{#each choices}}
            {{> typeChoice}}
          {{/each}}
        </div>
      {{/if}}
      {{#if typeIs "text"}}
        {{> typeText}}
      {{/if}}
    {{/each}}
    <div>
      <button class="save btn btn-large btn-primary">Save</button>
    </div>
  </div>
</template>

<template name="typeChoice">
  <button class="userinput btn btn-large" value="{{value}}">{{desc}}</button>
</template>

<template name="typeText">
  <div>
    <input class="userinput active input-xxlarge" type="text"></input>
  </div>
</template>

<template name="editor">
  {{#with editor}}
    <div>
      <input class="categoryname" type="text" placeholder="Category Name" value="{{name}}"></input>
    </div>
    <div>
      <input class="categorydesc" type="text" placeholder="Category Description" value="{{longdesc}}"></input>
    </div>
    <button class="addquestion btn btn-large">Add Question</button>
    {{#each questions}}
      {{> editorQuestion}}
    {{/each}}
    {{#if questions}}
      <button class="savecategory btn btn-large btn-primary">Save</button>
    {{/if}}
  {{/with}}
</template>

<template name="editorQuestion">
  <div class="editorquestion">
    <p>Question {{num}}</p>
    <div>
      <input class="prompt" type="text" placeholder="Enter a prompt..." value="{{label}}"></input>
    </div>
    <select class="type">
      {{#each questionTypes}}
        <option value="{{key}}">{{name}}</option>
      {{/each}}
    </select>
    {{#if typeIs "multiplechoice"}}
      <button class="addchoice btn">Add Choice</button>
      {{#each choices}}
        <div class="editorchoice" num="{{num}}">
          <p>Choice {{num}}</p>
          <input class="choicetext" type="text" placeholder="Choice text" value="{{desc}}"></input>
          <input class="choicevalue" type="text" placeholder="Choice value" value="{{value}}"></input>
          <div>
            <button class="deletechoice btn">Delete Choice</button>
          </div>
        </div>
      {{/each}}
    {{/if}}
    <div>
      <label class="checkbox">
        Optional <input type="checkbox" class="optional"></input>
      </label>
    </div>
    <div>
      <button class="deletequestion btn">Delete Question</button>
    </div>
  </div>
</template>
